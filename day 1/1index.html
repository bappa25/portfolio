<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --muted:#9aa4b2; --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,var(--bg),#07101a); font-family:Inter,Ui-sans-serif,system-ui,Arial; color:#e6eef6}
    .calculator{width:360px; max-width:96%; background:linear-gradient(180deg,var(--card), #071022); border-radius:16px; padding:20px; box-shadow:0 10px 30px rgba(2,6,23,0.7);}
    .header{display:flex; align-items:center; justify-content:space-between; margin-bottom:12px}
    .title{font-weight:600; font-size:18px}
    .theme-toggle{background:var(--glass); border:1px solid rgba(255,255,255,0.03); padding:6px 10px; border-radius:8px; cursor:pointer; color:var(--muted)}

    .screen{background:rgba(255,255,255,0.02); border-radius:10px; padding:14px; min-height:72px; display:flex; flex-direction:column; justify-content:center; align-items:flex-end; margin-bottom:14px;}
    .expression{font-size:14px; color:var(--muted); min-height:18px; width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    .result{font-size:28px; font-weight:600; margin-top:4px; width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}

    .keys{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    button.key{padding:16px; border-radius:10px; border:0; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); color:#e6eef6; font-size:18px; cursor:pointer; box-shadow:inset 0 -2px rgba(0,0,0,0.25)}
    button.key:active{transform:translateY(1px)}
    .key.operator{background:linear-gradient(180deg,var(--accent), #028a97); color:#042627; font-weight:700}
    .key.equal{grid-column:span 2; background:linear-gradient(180deg,#10b981, #04875f); color:white; font-weight:700}
    .key.clear{background:linear-gradient(180deg,#ef4444,#b91c1c); color:#fff}
    .key.wide{grid-column:span 2}

    .footer{margin-top:12px; font-size:12px; color:var(--muted); text-align:center}

    @media (max-width:420px){ .result{font-size:24px} .calculator{padding:14px} }
  </style>
</head>
<body>
  <div class="calculator" role="application" aria-label="Simple calculator">
    <div class="header">
      <div class="title">Simple Calculator</div>
      <button class="theme-toggle" id="toggleTheme" aria-pressed="false">Toggle</button>
    </div>

    <div class="screen" id="screen">
      <div class="expression" id="expression">&nbsp;</div>
      <div class="result" id="result">0</div>
    </div>

    <div class="keys" role="group" aria-label="Calculator keys">
      <button class="key clear" data-action="clear">C</button>
      <button class="key" data-action="back">⌫</button>
      <button class="key" data-action="percent">%</button>
      <button class="key operator" data-value="/">÷</button>

      <button class="key" data-value="7">7</button>
      <button class="key" data-value="8">8</button>
      <button class="key" data-value="9">9</button>
      <button class="key operator" data-value="*">×</button>

      <button class="key" data-value="4">4</button>
      <button class="key" data-value="5">5</button>
      <button class="key" data-value="6">6</button>
      <button class="key operator" data-value="-">−</button>

      <button class="key" data-value="1">1</button>
      <button class="key" data-value="2">2</button>
      <button class="key" data-value="3">3</button>
      <button class="key operator" data-value="+">+</button>

      <button class="key wide" data-value="0">0</button>
      <button class="key" data-value=".">.</button>
      <button class="key equal" data-action="equals">=</button>
    </div>

    <div class="footer">Supports keyboard input: numbers, + - * / . Enter =, Backspace</div>
  </div>

  <script>
    (()=>{
      const expressionEl = document.getElementById('expression');
      const resultEl = document.getElementById('result');
      const keys = document.querySelectorAll('button.key');

      let expr = '';

      function updateDisplay(){
        expressionEl.textContent = expr || '\u00A0';
        try{
          const safe = expr.replace(/×/g,'*').replace(/÷/g,'/');
          if(safe.trim()==='') { resultEl.textContent='0'; return }
          // evaluate safely: allow digits, operators, parentheses, decimal, percent
          if(/[^0-9+\-*/%.() ]/.test(safe)) { resultEl.textContent='Err'; return }
          let val = Function('return ('+safe+')')();
          if(typeof val==='number' && !Number.isFinite(val)) { resultEl.textContent='Math Err'; return }
          resultEl.textContent = (Math.round((val+Number.EPSILON)*100000000)/100000000).toString();
        }catch(e){ resultEl.textContent='Err' }
      }

      function append(value){
        // prevent two operators in a row (except - for negative)
        const last = expr.slice(-1);
        if(/[+\-*/%.]/.test(value)){
          if(expr==='' && value!=='-') return; // can't start with operator except -
          if(/[+\-*/%.]/.test(last)){ // replace last operator with new
            expr = expr.slice(0,-1) + value;
          }else{
            expr += value;
          }
        }else{
          expr += value;
        }
        updateDisplay();
      }

      function clearAll(){ expr=''; updateDisplay(); }
      function backspace(){ expr = expr.slice(0,-1); updateDisplay(); }
      function percent(){ // convert last number to percent
        // find last number
        const m = expr.match(/(\d*\.?\d+)$/);
        if(m){ const num = parseFloat(m[1]); const replaced = (num/100).toString(); expr = expr.slice(0, -m[1].length) + replaced; updateDisplay(); }
      }
      function equals(){
        try{
          const safe = expr.replace(/×/g,'*').replace(/÷/g,'/');
          if(/[^0-9+\-*/%.() ]/.test(safe)) { resultEl.textContent='Err'; return }
          let val = Function('return ('+safe+')')();
          if(typeof val==='number' && Number.isFinite(val)){
            expr = (Math.round((val+Number.EPSILON)*100000000)/100000000).toString(); updateDisplay();
          }else{ resultEl.textContent='Math Err' }
        }catch(e){ resultEl.textContent='Err' }
      }

      keys.forEach(k=>{
        k.addEventListener('click', ()=>{
          const v = k.dataset.value;
          const action = k.dataset.action;
          if(action==='clear') clearAll();
          else if(action==='back') backspace();
          else if(action==='percent') percent();
          else if(action==='equals') equals();
          else if(v) append(v);
        })
      })

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key>= '0' && e.key<='9') append(e.key);
        else if(e.key==='+'||e.key==='-'||e.key==='*'||e.key==='/'||e.key==='.' ) append(e.key);
        else if(e.key==='Enter' || e.key==='=') { e.preventDefault(); equals(); }
        else if(e.key==='Backspace') backspace();
        else if(e.key==='Escape') clearAll();
      })

      // theme toggle (simple)
      const toggle = document.getElementById('toggleTheme');
      toggle.addEventListener('click', ()=>{
        const pressed = toggle.getAttribute('aria-pressed') === 'true';
        if(!pressed){ document.body.style.background = 'linear-gradient(180deg,#f8fafc,#e6eef6)'; document.documentElement.style.setProperty('--card','#ffffff'); document.documentElement.style.setProperty('--bg','#f8fafc'); document.documentElement.style.setProperty('--accent','#7c3aed'); document.documentElement.style.setProperty('--muted','#334155'); toggle.setAttribute('aria-pressed','true'); }
        else{ document.body.style.background = 'linear-gradient(180deg,var(--bg),#07101a)'; document.documentElement.style.setProperty('--card','#0b1220'); document.documentElement.style.setProperty('--accent','#06b6d4'); document.documentElement.style.setProperty('--muted','#9aa4b2'); toggle.setAttribute('aria-pressed','false'); }
      })

      // init
      updateDisplay();
    })();
  </script>
</body>
</html>